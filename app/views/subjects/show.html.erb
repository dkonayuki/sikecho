<!-- sidebar -->
<div class="hidden-xs col-md-2 col-sm-2 sidebar-offcanvas" role="navigation">
	<div class="affix" role="complementary" id="show-subject-overview">
		<ul class="nav">
      <li class="active"><a href="#description">概要</a></li>
      <li><a href="#syllabus">シラバス</a></li>
      <li><a href="#notes">ノート</a></li>      
      <%= link_to schedule_path, class: 'btn btn-custom' do %>  
      <span class="glyphicon glyphicon-plus-sign"></span>登録
      <% end %>      
    </ul>
	</div>
</div>

<!-- main part -->
<div id="show-subject" class="col-md-10 col-sm-10 col-xs-12">
  <!--for overview section -->
	<a name="description"></a>
	<div class="skc-box skc-box-no-padding">
		<div class="skc-box-content">
			<div class="skc-box-thumbnail">
				<%= image_tag("lecture.png")  %>
			</div>
			<div class="skc-box-title">
				<a data-toggle="collapse" href="#collapseDescription">
	        <h4><%= @subject.name %></h4>
	      </a>
	    </div>
			<div class="skc-box-desc collapse in" id="collapseDescription">
				<p>
					<a href="#" id="subject-description"><%= sanitize(@subject.description) %></a>
				</p>
				<hr />
				<p>
					<strong>推奨学期:</strong>
					<%= link_to @subject.semester, filter_subjects_path(semester: @subject.semester) %>
				</p>
				<p>
					<strong>時間:</strong>
					<%= @subject.time_name %><%= @subject.day_name %>
				</p>
				<p>
					<strong>講義室:</strong>
					<%= @subject.place %>
				</p>
				<p>
					<strong>教員:</strong>
					<%= link_to @subject.teachers.first do %>
	      		<%= @subject.teachers.first.last_name_kanji %>
	      		<%= @subject.teachers.first.first_name_kanji %>
	      	<% end %>
				</p>
			</div>
		</div>
	</div>
	
  <!--for overview section -->
 	<a name="syllabus"></a>
	<div class="skc-box skc-box-no-padding">
		<div class="skc-box-content">
			<div class="skc-box-title-no-margin">
				<a data-toggle="collapse" href="#collapseSyllabus">
	        <h4>シラバス</h4>
	      </a>
	    </div>
			<div class="skc-box-desc skc-box-desc-no-margin collapse out" id="collapseSyllabus">
				<table class="table table-striped">
			    <thead>
			      <tr>
			        <th class="col-md-1 col-xs-1">回数</th>
			        <th class="col-md-2 col-xs-3">日付</th>
			        <th class="col-md-9 col-xs-8">内容</th>
			      </tr>
			    </thead>
			    <tbody>
			    	<% @subject.outlines.order('number ASC').each do | outline | %>
			      <tr>
			        <td><%= link_to "#{outline.number}回目", notes_in_show_subject_path(tag: "#{outline.number}回目", id: @subject.id, anchor: 'notes'), class: 'btn btn-primary btn-xs' %></td>
			        <td><a href="#" data-pk="<%= outline.number %>" class="outline-date"><%= outline.date %></a></td>
			        <td><a href="#" data-pk="<%= outline.number %>" class="outline-content"><%= sanitize(outline.content) %></a></td>
			      </tr>
			      <% end %>
			    </tbody>
			  </table>
			</div>
		</div>
	</div>
	
	
	<!--for overview section -->
 	<a name="notes"></a>
	<div class="skc-box skc-box-no-padding">
		<div class="skc-box-content">
			<div class="skc-box-title-no-margin">
				<a data-toggle="collapse" href="#collapseNotes">
	        <h4>ノート</h4>
	      </a>
	    </div>
			<div class="skc-box-desc skc-box-desc-no-margin collapse in" id="collapseNotes">
				<%= render 'layouts/list_notes'%>
			</div>
		</div>
	</div>
	
</div>
<script>
	//turn to inline mode
	$.fn.editable.defaults.mode = 'inline';
	$.fn.editable.defaults.ajaxOptions = {dataType: 'json', type: "PUT"};
	$(document).ready(function() {
	    $('#subject-description').editable({
			    type: 'wysihtml5',
			    wysihtml5: {
			    	locale: 'en-US',
			    	size: 'sm'
			    },
			    name: 'description',
			    pk: <%= @subject.id %>,
			    url: '/subjects/<%= @subject.id %>',
			});
			
			$('.outline-date').editable({
			    type: 'combodate',
			    wysihtml5: {
			    	locale: 'en-US',
			    	size: 'xs'
			    },
			    format: 'YYYY年MM月DD日', //for sending value
			    viewformat: 'YYYY年MM月DD日', //for view
			    template: 'YYYY / MM / DD',  //for combodate selector  
			    name: 'date',
	        combodate: {
	                minYear: 2000,
	                maxYear: 2015,
	        },
			    url: '/subjects/<%= @subject.id %>',
			});
			
			$('.outline-content').editable({
			    type: 'wysihtml5',
			    wysihtml5: {
			    	locale: 'en-US',
			    	size: 'sm'
			    },
			    name: 'content',
			    url: '/subjects/<%= @subject.id %>',
			});
	});
</script>