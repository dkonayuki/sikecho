<!-- 
<h1>Listing universities</h1>

<table>
  <thead>
    <tr>
    	<th>Picture</th>
      <th>Name</th>
      <th>Address</th>
      <th>Website</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @universities.each do |university| %>
      <tr>
      	<td><%= image_tag(university.display_logo_thumbnail, class: 'logo-thumbnail') %></td>
        <td><%= university.name %></td>
        <td><%= university.address %></td>
        <td><%= university.website %></td>
        <td><%= link_to 'Show', university %></td>
        <td><%= link_to 'Edit', edit_university_path(university) %></td>
        <td><%= link_to 'Destroy', university, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New University', new_university_path %>
-->
<div id="universities-list" class="clear">
	<%= render @universities %>
</div>

<%= link_to new_request_path, class: 'btn btn-request', id: 'uni-request-btn' do %>
	<span class="glyphicon glyphicon-plus"></span><br />
	<%= t('request_university') %>
<% end %>

<script>
	$(document).ready(function() {
		var container = document.querySelector('#universities-list');
		var msnry = new Masonry( container, {
		  // options
		  "gutter": 10,
		  "isFitWidth": true,
		  itemSelector: '.uni-item'
		});
		
	  /*For ajax popup link*/	
	  $('#uni-request-btn').magnificPopup({
	    // Delay in milliseconds before popup is removed
		  removalDelay: 300,
		
		  // Class that is added to popup wrapper and background
		  // make it unique to apply your CSS animations just to this exact popup
		  mainClass: 'mfp-zoom-in',
		  type: 'ajax',
	    callbacks: {
	   		parseAjax: function( mfpResponse ) {
	        mfpResponse.data = $(mfpResponse.data).find('#new-request');
			  },
		    ajaxContentAdded: function() {
			    // Ajax content is loaded and appended to DOM
				  	
					/*New request*/
					$("#new-request-form").on("submit", function() {
						$.ajax({
						  url: $(this).attr("action"),
						  dataType: "json",
						  data: $(this).serialize(),
						  type: "post",
							success: function() {
								//close popup after submit
								$.magnificPopup.close();
							}
						});
						return false;
					});
					
			  }
			}
		});
	});
</script>
