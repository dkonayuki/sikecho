<nav class="navbar navbar-default" role="navigation" id="nav-bar">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
	  <button type="button" class="navbar-toggle pull-right" data-toggle="collapse" data-target="#navbar-collapse-2" id="navbar-search">
	  	<span class="sr-only">Toggle navigation</span>
 			<i class="glyphicon glyphicon-search"></i>
 		</button>
    <button type="button" class="navbar-toggle pull-left" data-toggle="collapse" data-target="#navbar-collapse-1" id="navbar-menu">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <%= link_to image_tag("logo.png"), home_path, class: 'navbar-brand', id: 'logo' %>
  </div>
  
  <!-- Menu bar -->
  <div class="collapse navbar-collapse" id="navbar-collapse-1">
    <ul class="nav navbar-nav hidden-xs">
      <li class="<%= 'active' if params[:controller] == 'subjects' %>"><%= link_to '授業', faculties_path %></li>
      <li class="<%= 'active' if params[:controller] == 'notes' %> <%= 'disabled' if !user_signed_in? %>">
      	<%= link_to notes_path do %>
	      	ノート
	      	<% if user_signed_in? && unread_notes_count > 0 %>
	      		<span class="badge badge-important"><%= unread_notes_count %></span>
	      	<% end %>
      	<% end %>
    	</li>
      <li class="<%= 'active' if params[:controller] == 'users' %> <%= 'disabled' if !user_signed_in? %>"><%= link_to 'プロフィール', current_user %></li>
    </ul>
    
    <ul class="nav navbar-nav visible-xs nav-mobile">
      <li class="<%= 'active' if params[:controller] == 'subjects' %> col-xs-3"><%= link_to image_tag("lecture.png"), faculties_path %></li>
      <li class="<%= 'active' if params[:controller] == 'notes' %> col-xs-3 <%= 'disabled' if !user_signed_in? %>">
      	<%= link_to notes_path do %>
	      	<%= image_tag("note.png") %>
	      	<% if user_signed_in? && unread_notes_count > 0 %>
	      		<span class="badge badge-important"><%= unread_notes_count %></span>
	      	<% end %>
      	<% end %>
    	</li>
      <li class="<%= 'active' if params[:controller] == 'users' %> col-xs-3 <%= 'disabled' if !user_signed_in? %>"><%= link_to image_tag("user.png"), current_user %></li>
      <% if user_signed_in? %>
      <li class="col-xs-3"><%= link_to image_tag("logout.png"), destroy_user_session_path, method: :delete %></li>
      <% else %>
      <li class="col-xs-3"><%= link_to image_tag("login.png"), new_user_session_path %></li>
      <% end %>
    </ul>
  </div><!-- /.navbar-collapse -->
  
  <!-- Search bar -->
  <div class="collapse navbar-collapse" id="navbar-collapse-2">
	<%= form_tag search_path, class: "navbar-form navbar-left search-bar" do %>
	  <div class="input-group">
	    <%= text_field_tag :query, params[:query], class: 'form-control typeahead', placeholder: '検索' %>
			<div class="input-group-btn">
				<%= button_tag(type: "submit", class: "btn btn-success") do %>
				  <i class="glyphicon glyphicon-search"></i>
				<% end %>
			</div>
		</div>	    
	<% end %>
  </div><!-- /.navbar-collapse -->
  
  <% if user_signed_in? %>
  <!-- User info -->
	<div class="collapse navbar-collapse hidden-xs" id="navbar-collapse-3">
		<ul class="nav navbar-nav navbar-right">
    	<li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown"><%= current_user.display_name %> <b class="caret"></b></a>
        <ul class="dropdown-menu">
					<li><%= link_to 'プロフィール', current_user %></li>
					<li><%= link_to 'スケジュール', schedule_path %></li>           
					<li class="divider"></li>
    			<li><%= link_to 'ログアウト', destroy_user_session_path, method: :delete %></li>
        </ul>
      </li>
    </ul>
    <%= link_to image_tag("calendar.jpeg", class: 'nav-calendar'), schedule_path, class: "nav navbar-nav navbar-right" %>
  </div><!-- /.navbar-collapse -->
  <% else %>
  <%= link_to "ログイン", new_user_session_path, class: 'btn btn-sm btn-orange navbar-right hidden-xs', id: 'login-btn' %>
	<% end %>
	
</nav>